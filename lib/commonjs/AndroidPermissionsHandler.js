var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _reactNative=require("react-native");var ANDROID_FINE_LOCATION='android.permission.ACCESS_FINE_LOCATION';var ANDROID_BACKGROUND_LOCATION='android.permission.ACCESS_BACKGROUND_LOCATION';var ANDROID_ACTIVITY_RECOGNITION='android.permission.ACTIVITY_RECOGNITION';var ZendrivePermissions=_reactNative.NativeModules.ZendrivePermissions;var AndroidPermissionsHandler=function(){function AndroidPermissionsHandler(){(0,_classCallCheck2.default)(this,AndroidPermissionsHandler);}(0,_createClass2.default)(AndroidPermissionsHandler,[{key:"openSettings",value:function openSettings(){_reactNative.Linking.openSettings();return Promise.resolve(true);}},{key:"check",value:function check(kind){var basicPermissionGranted,fineLocation,backgroundLocation;return _regenerator.default.async(function check$(_context){while(1)switch(_context.prev=_context.next){case 0:basicPermissionGranted=false;fineLocation=false;backgroundLocation=true;_context.t0=kind;_context.next=_context.t0==='location'?6:_context.t0==='motion'?15:_context.t0==='overlay'?21:22;break;case 6:_context.next=8;return _regenerator.default.awrap(_reactNative.PermissionsAndroid.check(ANDROID_FINE_LOCATION));case 8:fineLocation=_context.sent;if(!(_reactNative.Platform.OS==='android'&&_reactNative.Platform.Version>=29)){_context.next=14;break;}console.log('Checking for background location');_context.next=13;return _regenerator.default.awrap(_reactNative.PermissionsAndroid.check(ANDROID_BACKGROUND_LOCATION));case 13:backgroundLocation=_context.sent;case 14:return _context.abrupt("return",Promise.resolve(fineLocation&&backgroundLocation));case 15:if(!(_reactNative.Platform.OS==='android'&&_reactNative.Platform.Version>=29)){_context.next=20;break;}_context.next=18;return _regenerator.default.awrap(_reactNative.PermissionsAndroid.check(ANDROID_ACTIVITY_RECOGNITION));case 18:basicPermissionGranted=_context.sent;return _context.abrupt("return",Promise.resolve(basicPermissionGranted));case 20:return _context.abrupt("return",Promise.resolve(true));case 21:return _context.abrupt("return",ZendrivePermissions.checkOverlay());case 22:throw new Error('not-yet-implemented');case 23:case"end":return _context.stop();}},null,null,null,Promise);}},{key:"request",value:function request(kind,rationale){var basicPermissionGranted,hasAllGrants,getFineLocation,getBackgroundLocation;return _regenerator.default.async(function request$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!(_reactNative.Platform.OS==='ios')){_context2.next=2;break;}throw new Error('Not yet implemented');case 2:basicPermissionGranted='denied';hasAllGrants=true;getFineLocation='';getBackgroundLocation='';_context2.t0=kind;_context2.next=_context2.t0==='location'?9:_context2.t0==='motion'?17:_context2.t0==='overlay'?23:24;break;case 9:_context2.next=11;return _regenerator.default.awrap(_reactNative.PermissionsAndroid.request(ANDROID_FINE_LOCATION));case 11:getFineLocation=_context2.sent;_context2.next=14;return _regenerator.default.awrap(_reactNative.PermissionsAndroid.request(ANDROID_BACKGROUND_LOCATION));case 14:getBackgroundLocation=_context2.sent;if(getFineLocation==='granted'&&getBackgroundLocation==='granted'){hasAllGrants=true;}else{hasAllGrants=false;}return _context2.abrupt("return",Promise.resolve(hasAllGrants));case 17:if(!(_reactNative.Platform.OS==='android'&&_reactNative.Platform.Version>=29)){_context2.next=22;break;}_context2.next=20;return _regenerator.default.awrap(_reactNative.PermissionsAndroid.request(ANDROID_ACTIVITY_RECOGNITION,rationale));case 20:basicPermissionGranted=_context2.sent;return _context2.abrupt("return",Promise.resolve(basicPermissionGranted==='granted'));case 22:return _context2.abrupt("return",Promise.resolve(true));case 23:return _context2.abrupt("return",ZendrivePermissions.requestOverlay());case 24:throw new Error('not-yet-implemented');case 25:case"end":return _context2.stop();}},null,null,null,Promise);}},{key:"openAdvancedBatterySettings",value:function openAdvancedBatterySettings(){return _regenerator.default.async(function openAdvancedBatterySettings$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",ZendrivePermissions.openAdvancedBatterySettings());case 1:case"end":return _context3.stop();}},null,null,null,Promise);}}]);return AndroidPermissionsHandler;}();exports.default=AndroidPermissionsHandler;
//# sourceMappingURL=AndroidPermissionsHandler.js.map